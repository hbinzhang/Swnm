<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sqlMap 
    PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" 
    "http://www.ibatis.com/dtd/sql-map-2.dtd">
<sqlMap namespace="com.dao.videomonitor.TVmNvrMapper">
 <resultMap id="BaseResultMap1" class="com.entity.videomonitor.TVmNvr">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Apr 04 10:52:12 CST 2015.
    -->
    <result column="NVRID" jdbcType="VARCHAR" property="nvrid" />
    <result column="NVRIP" jdbcType="VARCHAR" property="ip" />
    <result column="NVRPORT" jdbcType="DECIMAL" property="port" />
    <result column="NVRNETMASK" jdbcType="VARCHAR" property="netmask" />
    <result column="NVRGATEWAY" jdbcType="VARCHAR" property="gateway" />
    <result column="NVRUSERNAME2" jdbcType="VARCHAR" property="username2" />
    <result column="NVRPASSWORD" jdbcType="VARCHAR" property="password" />
    <result column="NVRDEVNAME" jdbcType="VARCHAR" property="devname" />
    <result column="NVRDEVFRIENDLYNAME" jdbcType="VARCHAR" property="devfriendlyname" />
    <result column="NVRDISKNUM" jdbcType="DECIMAL" property="disknum" />
    <result column="NVRMANAGEMENTAGENCY" jdbcType="VARCHAR" property="managementagency" />
    <result column="NVRVERSION" jdbcType="VARCHAR" property="version" />
    <result column="NVRBRANCH" jdbcType="VARCHAR" property="branch" />
    <result column="VENDORID" property="vendor"
			javaType="com.entity.videomonitor.TVmManufacturer" resultMap="com.dao.videomonitor.TVmManufacturerMapper.BaseResultMap"/>
  </resultMap>
  <resultMap id="BaseResultMap" class="com.entity.videomonitor.TVmNvr">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Apr 04 10:52:12 CST 2015.
    -->
    <result column="NVRID" jdbcType="VARCHAR" property="nvrid" />
    <result column="vendorid" jdbcType="VARCHAR" property="vendor.vendorid"/>
    <result column="IP" jdbcType="VARCHAR" property="ip" />
    <result column="PORT" jdbcType="DECIMAL" property="port" />
    <result column="NETMASK" jdbcType="VARCHAR" property="netmask" />
    <result column="GATEWAY" jdbcType="VARCHAR" property="gateway" />
    <result column="USERNAME" jdbcType="VARCHAR" property="username2" />
    <result column="PASSWORD" jdbcType="VARCHAR" property="password" />
    <result column="DEVNAME" jdbcType="VARCHAR" property="devname" />
    <result column="DEVFRIENDLYNAME" jdbcType="VARCHAR" property="devfriendlyname" />
    <result column="DISKNUM" jdbcType="DECIMAL" property="disknum" />
    <result column="MANAGEMENTAGENCY" jdbcType="VARCHAR" property="managementagency" />
    <result column="VERSION" jdbcType="VARCHAR" property="version" />
    <result column="BRANCH" jdbcType="VARCHAR" property="branch" />
  </resultMap>
  
   <select id="selectNvrByRole" parameterClass="java.util.Map" resultMap="BaseResultMap">
    select
    *
    from T_VM_NVR
    where 0=0 
   		<dynamic>
			<isNotNull property="cond.managementagency">
			and #cond.managementagency# =
			MANAGEMENTAGENCY
			</isNotNull>
			<isNotNull property="cond.branch">
			and #cond.branch# =
			BRANCH
			</isNotNull>
		</dynamic>
  </select>
   <insert id="insertNvrSelective" parameterClass="com.entity.videomonitor.TVmNvr">    
    insert into T_VM_NVR
    <dynamic open="(" close=")">
    	<isNotNull property="nvrid">NVRID</isNotNull>
    	<isNotNull property="vendor.vendorid" prepend=",">VENDORID</isNotNull>
    	<isNotNull property="ip" prepend=",">IP</isNotNull>
    	<isNotNull property="port" prepend=",">PORT</isNotNull>
    	<isNotNull property="netmask" prepend=",">NETMASK</isNotNull>
		<isNotNull property="gateway" prepend=",">GATEWAY</isNotNull>
		<isNotNull property="username2" prepend=",">USERNAME</isNotNull>
		<isNotNull property="password" prepend=",">PASSWORD</isNotNull>
		<isNotNull property="devname" prepend=",">DEVNAME</isNotNull>
		<isNotNull property="devfriendlyname" prepend=",">DEVFRIENDLYNAME</isNotNull>
		<isNotNull property="disknum" prepend=",">DISKNUM</isNotNull>
		<isNotNull property="managementagency" prepend=",">MANAGEMENTAGENCY</isNotNull>
		<isNotNull property="version" prepend=",">VERSION</isNotNull>
		<isNotNull property="branch" prepend=",">BRANCH</isNotNull> 
    </dynamic>
    <dynamic prepend="values" open="(" close=")">
    	<isNotNull property="nvrid" prepend=",">#nvrid#</isNotNull>
    	<isNotNull property="vendor.vendorid" prepend=",">#vendor.vendorid#</isNotNull>
    	<isNotNull property="ip" prepend=",">#ip#</isNotNull>
    	<isNotNull property="port" prepend=",">#port#</isNotNull>
    	<isNotNull property="netmask" prepend=",">#netmask#</isNotNull>
		<isNotNull property="gateway" prepend=",">#gateway#</isNotNull>
		<isNotNull property="username2" prepend=",">#username2#</isNotNull>
		<isNotNull property="password" prepend=",">#password#</isNotNull>
		<isNotNull property="devname" prepend=",">#devname#</isNotNull>
		<isNotNull property="devfriendlyname" prepend=",">#devfriendlyname#</isNotNull>
		<isNotNull property="disknum" prepend=",">#disknum#</isNotNull>
		<isNotNull property="managementagency" prepend=",">#managementagency#</isNotNull>
		<isNotNull property="version" prepend=",">#version#</isNotNull>
		<isNotNull property="branch" prepend=",">#branch#</isNotNull> 
    </dynamic>
  </insert>
   <select id="selectNvrByPage" parameterClass="java.util.Map" resultMap="BaseResultMap">
		select t1.* from
		(select
		i.*,

		m.vendorName, m.desciption,
		row_number() over(order by i.DEVNAME) rk
		from T_VM_NVR i
		left join
		T_VM_MANUFACTURER m
		on i.vendorid = m.vendorid
		where 0 = 0
		<dynamic>
			<isNotNull property="cond.managementagency">
			and #cond.managementagency# =
			i.MANAGEMENTAGENCY
			</isNotNull>
			<isNotNull property="cond.branch">
			and #cond.branch# =
			i.BRANCH
			</isNotNull>
			<isNotNull property="cond.atype">
				<isEqual property="cond.atype" compareValue="1">
					and i.nvrid=#cond.avalue#
  				</isEqual>
  				<isEqual property="cond.atype" compareValue="2">
					and i.ip=#cond.avalue#
  				</isEqual>
  				<isEqual property="cond.atype" compareValue="3">
					and i.devname like '%$cond.avalue$%'
  				</isEqual>
			</isNotNull>
		</dynamic>
		)t1
		where t1.rk &gt;= #cond.fromRow# and t1.rk &lt;=
		#cond.toRow#
	</select>
	<select id="selectNvrByPageRowCount" parameterClass="java.util.Map"
		resultClass="int">
		select
		count(*)
		from T_VM_NVR i where 0 = 0
		<dynamic>
			<isNotNull property="cond.managementagency">
			and #cond.managementagency# =
			i.MANAGEMENTAGENCY
			</isNotNull>
			<isNotNull property="cond.branch">
			and #cond.branch# =
			i.BRANCH
			</isNotNull>
			<isNotNull property="cond.atype">
				<isEqual property="cond.atype" compareValue="1">
					and i.nvrid=#cond.avalue#
  				</isEqual>
  				<isEqual property="cond.atype" compareValue="2">
					and i.ip=#cond.avalue#
  				</isEqual>
  				<isEqual property="cond.atype" compareValue="3">
					and i.devname like '%$cond.avalue$%'
  				</isEqual>
			</isNotNull>
		</dynamic>
	</select>
	 <select id="selectNvrByPrimaryKey" parameterClass="java.lang.String" resultMap="BaseResultMap">
    select 
    *
    from T_VM_NVR
    where NVRID = #nvrid#
  </select>
  <update id="updateNvrByPrimaryKeySelective" parameterClass="com.entity.videomonitor.TVmNvr">
    update T_VM_NVR
    	<dynamic prepend="set">
			<isNotNull property="vendor.vendorid" prepend=",">VENDORID = #vendor.vendorid#</isNotNull>
			<isNotNull property="ip" prepend=",">IP = #ip#</isNotNull>
			<isNotNull property="port" prepend=",">PORT = #port#</isNotNull>
			<isNotNull property="netmask" prepend=",">NETMASK = #netmask#</isNotNull>
			<isNotNull property="gateway" prepend=",">GATEWAY = #gateway#</isNotNull>
			<isNotNull property="username2" prepend=",">USERNAME = #username2#</isNotNull>
			<isNotNull property="password" prepend=",">PASSWORD = #password#</isNotNull>
			<isNotNull property="devname" prepend=",">DEVNAME = #devname#</isNotNull>
			<isNotNull property="devfriendlyname" prepend=",">DEVFRIENDLYNAME = #devfriendlyname#</isNotNull>
			<isNotNull property="managementagency" prepend=",">MANAGEMENTAGENCY = #managementagency#</isNotNull>
			<isNotNull property="version" prepend=",">VERSION = #version#</isNotNull>
			<isNotNull property="branch" prepend=",">BRANCH = #branch#</isNotNull>
		</dynamic>
    where NVRID = #nvrid#
  </update>
  <delete id="deleteNvrByPrimaryKey" parameterClass="java.lang.String">
    delete from T_VM_NVR
    where NVRID = #nvrid#
  </delete>
  <select id="testNvrExistById" parameterClass="java.lang.String" resultClass="int">
		select count(*) from T_VM_NVR where nvrid = #nvrid#
	</select>
</sqlMap>